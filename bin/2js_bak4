#!/usr/bin/env node

var PanPG = require("../lib/PanPG");
var PanPGUtil = require("../lib/PanPG_util");
var fs = require('fs');
var sys = require('sys');

// var grammar = 'Simple ← String / Integer\n' +
// 			  'String ← [a-z]+\n' +
// 			  'Integer ← [0-9]+\n' +
// 			  'For ← Expression';
var grammar = fs.readFileSync('./lib/grammars/ECMAScript_5.peg', 'utf-8');

var streamable = fs.readFileSync('./lib/grammars/ECMAScript_5_streamable.peg', 'utf-8');

var parser = PanPG.generateParser( grammar, {start:'Program', fname: 'parseES5', patches:[streamable]}, {} );

eval(parser);

var code = 'var c = function() { alert(423); }';

var result = parseES5(code);
console.log(PanPGUtil.showTree(result));